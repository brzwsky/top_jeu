const observerRegistry={scrollObservers:new Map(),globalScrollObserver:null,};const MOBILE_MAX_WIDTH=768;function isMobileViewport(){const doc=document.documentElement;const candidates=[typeof window.innerWidth==='number'?window.innerWidth:null,doc&&typeof doc.clientWidth==='number'?doc.clientWidth:null,window.screen&&typeof window.screen.width==='number'?window.screen.width:null,].filter((value)=>value&&value>0);if(!candidates.length)return window.innerWidth<=MOBILE_MAX_WIDTH;return Math.min(...candidates)<=MOBILE_MAX_WIDTH}
class CookieConsentManager{constructor(){this.banner=document.getElementById('cookie-banner');this.acceptBtn=document.getElementById('cookie-accept');this.declineBtn=document.getElementById('cookie-decline');this.settingsLink=document.getElementById('cookie-settings-link');this.minimizedIcon=this.banner?.querySelector('.cookie-banner__minimized-icon',);this.container=this.banner?.querySelector('.cookie-banner__container');this.analyticsBanner=document.querySelector('.cookie-consent-banner');this.analyticsAccept=document.getElementById('accept-analytics-btn');this.consentKey='cookieConsent';this.analyticsConsentKey='analyticsConsent';this.analyticsLoaded=!1;this.ahrefsLoaded=!1;this.init()}
init(){this.loadConsentState();this.setupEventListeners();this.loadAnalyticsIfConsented();this.setupAnalyticsBanner()}
loadConsentState(){if(!this.banner)return;const consent=localStorage.getItem(this.consentKey);if(!consent){requestAnimationFrame(()=>{setTimeout(()=>this.showBanner(),2000)})}else if(consent==='accepted'){this.banner.style.display='none'}else if(consent==='declined'){this.minimizeBanner()}}
showBanner(){if(!this.banner)return;this.banner.classList.add('show');if(this.acceptBtn)this.acceptBtn.focus();}
minimizeBanner(){if(!this.banner||!this.container)return;this.banner.classList.remove('show');this.banner.classList.add('minimized');this.container.style.opacity='0';this.container.style.maxHeight='0'}
expandBanner(){if(!this.banner||!this.container)return;this.banner.classList.remove('minimized');this.banner.classList.add('expanding');setTimeout(()=>{this.banner.classList.add('show');this.container.style.maxHeight=this.container.scrollHeight+'px';this.container.style.opacity='1'},20);setTimeout(()=>{this.banner.classList.remove('expanding');this.container.style.maxHeight='none'},450)}
setupEventListeners(){if(!this.banner)return;document.addEventListener('click',(e)=>{if(e.target===this.acceptBtn){this.acceptCookies()}else if(e.target===this.declineBtn){this.declineCookies()}else if(e.target===this.settingsLink){e.preventDefault();this.resetAndShowBanner()}else if(e.target===this.minimizedIcon){this.expandBanner()}else if(e.target===this.banner&&this.banner.classList.contains('minimized')){this.expandBanner()}});document.addEventListener('keydown',(e)=>{const isActivateKey=e.key==='Enter'||e.key===' ';if(e.target===this.settingsLink&&isActivateKey){e.preventDefault();this.resetAndShowBanner()}else if(e.target===this.minimizedIcon&&isActivateKey){e.preventDefault();this.expandBanner()}})}
setupAnalyticsBanner(){if(!this.analyticsBanner||!this.analyticsAccept)return;this.analyticsBanner.classList.remove('fade-in');this.analyticsBanner.classList.remove('hidden');this.analyticsBanner.setAttribute('aria-hidden','true');const analyticsChoice=localStorage.getItem(this.analyticsConsentKey);if(analyticsChoice==='accepted'){this.hideAnalyticsBanner()}else{requestAnimationFrame(()=>{setTimeout(()=>{this.showAnalyticsBanner()},2000)})}
this.analyticsAccept.addEventListener('click',()=>{localStorage.setItem(this.analyticsConsentKey,'accepted');this.hideAnalyticsBanner();if(typeof gtag!=='undefined'){gtag('consent','update',{analytics_storage:'granted',ad_storage:'granted',})}})}
showAnalyticsBanner(){if(!this.analyticsBanner)return;requestAnimationFrame(()=>{this.analyticsBanner.style.display='';this.analyticsBanner.classList.add('show');this.analyticsBanner.classList.add('visible');this.analyticsBanner.setAttribute('aria-hidden','false')})}
hideAnalyticsBanner(){if(!this.analyticsBanner)return;this.analyticsBanner.classList.remove('show');this.analyticsBanner.classList.remove('visible');this.analyticsBanner.setAttribute('aria-hidden','true');this.analyticsBanner.style.display='none'}
resetAndShowBanner(){if(!this.banner||!this.container)return;this.banner.style.display='';this.banner.classList.remove('minimized');this.container.style.maxHeight='';this.container.style.opacity='1';this.showBanner()}
acceptCookies(){localStorage.setItem(this.consentKey,'accepted');if(this.banner){this.banner.classList.remove('show');this.banner.style.display='none'}
this.loadAnalytics();this.updateGtagConsent('granted')}
declineCookies(){localStorage.setItem(this.consentKey,'declined');this.minimizeBanner();this.disableAnalytics();this.updateGtagConsent('denied')}
loadAnalytics(){if(this.analyticsLoaded)return;this.loadGoogleAnalytics();this.loadAhrefsAnalytics();this.analyticsLoaded=!0}
loadGoogleAnalytics(){const script=document.createElement('script');script.async=!0;script.src='https://www.googletagmanager.com/gtag/js?id=G-YYE4H0PHYY';document.head.appendChild(script);script.onload=()=>{if(typeof gtag!=='undefined'){gtag('js',new Date());gtag('config','G-YYE4H0PHYY')}}}
loadAhrefsAnalytics(){const script=document.createElement('script');script.async=!0;script.src='https://analytics.ahrefs.com/analytics.js';script.setAttribute('data-key','flKbnmCKyZQK+Qsr+U37qQ');document.head.appendChild(script);this.ahrefsLoaded=!0}
disableAnalytics(){if(typeof gtag!=='undefined'){gtag('consent','update',{analytics_storage:'denied',ad_storage:'denied',})}
this.removeAnalyticsCookies()}
removeAnalyticsCookies(){const cookies=['_ga','_gid','_gat','_gcl_au','_fbp','_uetsid','_uetvid',];const past='Thu, 01 Jan 1970 00:00:00 GMT';cookies.forEach((cookie)=>{document.cookie=`${cookie}=; expires=${past}; path=/; domain=.${window.location.hostname}`;document.cookie=`${cookie}=; expires=${past}; path=/`})}
updateGtagConsent(status){if(typeof gtag!=='undefined'){gtag('consent','update',{analytics_storage:status,ad_storage:status,})}}
loadAnalyticsIfConsented(){const consent=localStorage.getItem(this.consentKey);if(consent==='accepted'){this.loadAnalytics()}}
clearConsent(){localStorage.removeItem(this.consentKey);this.disableAnalytics();this.removeAnalyticsCookies();if(this.banner&&this.container){this.banner.style.display='';this.banner.classList.remove('minimized');this.container.style.maxHeight='';this.container.style.opacity='1';setTimeout(()=>this.showBanner(),10)}}}
class PopupManager{constructor(){this.popup=document.getElementById('popup');this.popupClose=document.getElementById('popup-close');this.popupContact=document.getElementById('popup-contact');this.popupContactClose=document.getElementById('popup-contact-close');this.privacyPopup=document.getElementById('privacy-popup');this.privacyClose=document.getElementById('privacy-close');this.lastFocusedElement=null;this.isClosing=!1;this.isOpening=!1;this.activeModals=new Set();this.modalStack=[];this.visualFeedback=!0;this.animationDuration=200;this.feedbackTimeout=null;this.init()}
init(){this.setupEventListeners()}
setupEventListeners(){document.addEventListener('click',(e)=>{const trigger=e.target?.closest?.('[data-popup-target]');if(trigger&&trigger.dataset.popupTarget){e.preventDefault();this.openByTarget(trigger.dataset.popupTarget);return}
if(e.target===this.popupClose||e.target?.closest?.('#popup-close')){this.closePopup(this.popup)}else if(e.target===this.popupContactClose||e.target?.closest?.('#popup-contact-close')){this.closePopup(this.popupContact)}else if(e.target===this.privacyClose){this.closePrivacyPopup()}else if(e.target===this.popup){this.closePopup(this.popup)}else if(e.target===this.popupContact){this.closePopup(this.popupContact)}else if(e.target===this.privacyPopup){this.closePrivacyPopup()}});document.addEventListener('keydown',(e)=>{const isActivateKey=e.key==='Enter'||e.key===' ';const trigger=e.target?.closest?.('[data-popup-target]');if(trigger&&trigger.dataset.popupTarget&&isActivateKey){e.preventDefault();this.openByTarget(trigger.dataset.popupTarget)}else if(e.key==='Escape'){if(this.popup&&!this.popup.classList.contains('hidden')){this.closePopup(this.popup)}else if(this.popupContact&&!this.popupContact.classList.contains('hidden')){this.closePopup(this.popupContact)}else if(this.privacyPopup&&this.privacyPopup.classList.contains('show')){this.closePrivacyPopup()}}})}
openByTarget(target){if(!target)return;switch(target){case 'about':this.openPopup(this.popup);break;case 'contact':this.openPopup(this.popupContact);break;case 'privacy':this.openPrivacyPopup();break;default:break}}
openPopup(popupElement){if(!popupElement||this.isClosing||this.isOpening)return;if(this.activeModals.has(popupElement)){return}
this.isOpening=!0;this.closeAllModals();if(this.visualFeedback){popupElement.style.opacity='0';popupElement.style.transition=`opacity ${this.animationDuration}ms ease, transform ${this.animationDuration}ms ease`;popupElement.style.transform='scale(0.95)';popupElement.style.background='transparent';popupElement.style.pointerEvents='none';popupElement.style.willChange='opacity, transform'}
setTimeout(()=>{if(this.isClosing){this.isOpening=!1;return}
this.closeMenu();this.lastFocusedElement=document.activeElement;popupElement.classList.remove('hidden');if(popupElement===this.popup&&window.aboutCarousel){window.aboutCarousel.reset()}
if(this.visualFeedback){requestAnimationFrame(()=>{popupElement.style.opacity='1';popupElement.style.transform='scale(1)';popupElement.style.pointerEvents='auto';popupElement.style.background=''})}
const closeButton=popupElement.querySelector('.popup__close');if(closeButton)closeButton.focus();document.documentElement.style.overflow='hidden';this.activeModals.add(popupElement);this.modalStack.push(popupElement);this.feedbackTimeout=setTimeout(()=>{this.isOpening=!1;if(this.visualFeedback){popupElement.style.transition='';popupElement.style.opacity='';popupElement.style.transform='';popupElement.style.background='';popupElement.style.pointerEvents='';popupElement.style.willChange=''}},this.animationDuration)},50)}
closePopup(popupElement){if(!popupElement||this.isClosing||this.isOpening)return;this.isClosing=!0;if(this.visualFeedback){popupElement.style.background='transparent';popupElement.style.pointerEvents='none';popupElement.style.transition=`opacity ${this.animationDuration}ms ease, transform ${this.animationDuration}ms ease`;popupElement.style.opacity='0';popupElement.style.transform='scale(0.95)';setTimeout(()=>{popupElement.classList.add('hidden');popupElement.style.transition='';popupElement.style.opacity='';popupElement.style.transform='';popupElement.style.background='';popupElement.style.pointerEvents=''},this.animationDuration)}else{popupElement.classList.add('hidden')}
if(this.lastFocusedElement)this.lastFocusedElement.focus();document.documentElement.style.overflow='auto';this.activeModals.delete(popupElement);const index=this.modalStack.indexOf(popupElement);if(index>-1){this.modalStack.splice(index,1)}
setTimeout(()=>{this.isClosing=!1},300)}
openPrivacyPopup(){if(!this.privacyPopup||this.isClosing)return;this.closeMenu();this.lastFocusedElement=document.activeElement;this.privacyPopup.classList.add('show');this.privacyPopup.setAttribute('aria-hidden','false');const closeButton=this.privacyPopup.querySelector('.privacy-popup__close',);if(closeButton)closeButton.focus();document.documentElement.style.overflow='hidden';document.body.classList.add('modal-open')}
closePrivacyPopup(){if(!this.privacyPopup||this.isClosing)return;this.isClosing=!0;this.privacyPopup.classList.remove('show');this.privacyPopup.setAttribute('aria-hidden','true');if(this.lastFocusedElement)this.lastFocusedElement.focus();document.documentElement.style.overflow='auto';document.body.classList.remove('modal-open');setTimeout(()=>{this.isClosing=!1},300)}
closeMenu(){if(window.mobileMenuManager&&typeof window.mobileMenuManager.closeMenu==='function'){window.mobileMenuManager.closeMenu({restoreFocus:!1});return}
const menu=document.querySelector('.nav-menu');const burger=document.querySelector('.burger');if(menu&&burger&&menu.classList.contains('active')){menu.classList.remove('active');const isMobile=isMobileViewport();if(isMobile){menu.setAttribute('aria-hidden','true');setTimeout(()=>{if(!menu.classList.contains('active')&&isMobileViewport()){menu.setAttribute('hidden','')}},400);burger.style.display='flex'}else{menu.removeAttribute('hidden');menu.setAttribute('aria-hidden','false');burger.style.display=''}
document.body.classList.remove('menu-open');burger.setAttribute('aria-expanded','false')}}
closeAllModals(){this.activeModals.forEach((modal)=>{if(modal===this.popup){this.closePopup(modal)}else if(modal===this.popupContact){this.closePopup(modal)}else if(modal===this.privacyPopup){this.closePrivacyPopup()}});this.activeModals.clear();this.modalStack=[]}
getTopModal(){return this.modalStack[this.modalStack.length-1]}
hasActiveModals(){return this.activeModals.size>0}
debounceModalOperation(operation,delay=100){clearTimeout(this.modalDebounceTimer);this.modalDebounceTimer=setTimeout(operation,delay)}
safeOpenPopup(popupElement){if(this.isClosing||this.activeModals.has(popupElement))return;this.debounceModalOperation(()=>{this.openPopup(popupElement)})}
safeClosePopup(popupElement){if(this.isClosing)return;this.debounceModalOperation(()=>{this.closePopup(popupElement)})}
resetModalState(){this.isClosing=!1;this.isOpening=!1;this.activeModals.clear();this.modalStack=[];document.documentElement.style.overflow='auto';document.body.classList.remove('modal-open');if(this.visualFeedback){[this.popup,this.popupContact,this.privacyPopup].forEach((modal)=>{if(modal){modal.style.transition='';modal.style.opacity=''}})}}
setVisualFeedback(enabled){this.visualFeedback=enabled}
getModalState(){return{isClosing:this.isClosing,isOpening:this.isOpening,activeModals:Array.from(this.activeModals),modalStack:this.modalStack,visualFeedback:this.visualFeedback,animationDuration:this.animationDuration,}}
setAnimationDuration(duration){this.animationDuration=Math.max(100,Math.min(1000,duration))}
enhanceVisualFeedback(){const activeModal=this.getTopModal();if(activeModal&&this.visualFeedback){activeModal.style.animation='shake 0.3s ease-in-out';setTimeout(()=>{activeModal.style.animation=''},300)}}}
class AboutCarousel{constructor(){this.root=document.querySelector('[data-carousel]');this.track=this.root?.querySelector('[data-carousel-track]')||null;this.slides=this.track?Array.from(this.track.querySelectorAll('[data-carousel-slide]')):[];this.viewport=this.root?.querySelector('.testimonial-carousel__viewport');this.prevBtn=this.root?.querySelector('[data-carousel-prev]')||null;this.nextBtn=this.root?.querySelector('[data-carousel-next]')||null;this.dotsContainer=this.root?.querySelector('[data-carousel-dots]')||null;this.dots=[];this.currentIndex=0;this.touchStartX=0;this.touchDeltaX=0;this.isTouching=!1;this.autoAdvanceTimer=null;this.autoAdvanceDelay=5000;if(!this.root||!this.track||this.slides.length===0)return;this.root.setAttribute('role','region');this.root.setAttribute('aria-live','polite');this.root.setAttribute('aria-roledescription','carousel');this.handleClick=this.handleClick.bind(this);this.handleKeydown=this.handleKeydown.bind(this);this.handleTouchStart=this.handleTouchStart.bind(this);this.handleTouchMove=this.handleTouchMove.bind(this);this.handleTouchEnd=this.handleTouchEnd.bind(this);this.handleResize=this.handleResize.bind(this);this.enhanceSlides();this.setupDots();this.update();this.deferHeight();this.root.addEventListener('click',this.handleClick);this.root.addEventListener('keydown',this.handleKeydown);this.root.addEventListener('touchstart',this.handleTouchStart,{passive:!0,});this.root.addEventListener('touchmove',this.handleTouchMove,{passive:!0,});this.root.addEventListener('touchend',this.handleTouchEnd);window.addEventListener('resize',this.handleResize,{passive:!0});this.startAutoAdvance()}
enhanceSlides(){const total=this.slides.length;this.slides.forEach((slide,index)=>{if(!slide.id){slide.id=`testimonial-slide-${index + 1}`}
slide.setAttribute('role','group');slide.setAttribute('aria-label',`Témoignage ${index + 1} sur ${total}`);slide.setAttribute('aria-roledescription','slide')});if(this.slides.length<=1){this.toggleControls(!1)}}
toggleControls(visible){const display=visible?'':'none';if(this.prevBtn)this.prevBtn.style.display=display;if(this.nextBtn)this.nextBtn.style.display=display;if(this.dotsContainer)
this.dotsContainer.style.display=visible?'':'none'}
setupDots(){if(!this.dotsContainer||this.slides.length<=1)return;this.dotsContainer.innerHTML='';this.dots=this.slides.map((slide,index)=>{const dot=document.createElement('button');dot.type='button';dot.className='testimonial-carousel__dot';dot.setAttribute('data-carousel-dot',String(index));dot.setAttribute('role','tab');dot.setAttribute('aria-controls',slide.id);dot.setAttribute('aria-label',`Aller au témoignage ${index + 1}`);dot.setAttribute('tabindex',index===0?'0':'-1');this.dotsContainer.appendChild(dot);return dot});this.dotsContainer.setAttribute('role','tablist');this.dotsContainer.setAttribute('aria-label','Pagination des témoignages')}
update(){this.track.style.transform=`translateX(-${this.currentIndex * 100}%)`;this.slides.forEach((slide,index)=>{const isActive=index===this.currentIndex;slide.setAttribute('aria-hidden',String(!isActive));slide.setAttribute('tabindex',isActive?'0':'-1');slide.classList.toggle('testimonial-card--active',isActive)});this.dots.forEach((dot,index)=>{const isActive=index===this.currentIndex;dot.setAttribute('aria-selected',String(isActive));dot.setAttribute('tabindex',isActive?'0':'-1')})}
deferHeight(){if(!this.viewport)return;requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.updateHeight()})})}
updateHeight(){if(!this.viewport)return;const activeSlide=this.slides[this.currentIndex];if(!activeSlide)return;if(!this.viewport.offsetParent){this.viewport.style.height='';return}
const height=activeSlide.offsetHeight;requestAnimationFrame(()=>{if(height){this.viewport.style.height=`${height}px`}})}
showSlide(index,source='button'){if(this.slides.length===0)return;const total=this.slides.length;const nextIndex=(index+total)%total;this.currentIndex=nextIndex;this.update();this.deferHeight();if(source==='dot'){const activeDot=this.dots[this.currentIndex];if(activeDot)activeDot.focus();}}
reset(){if(!this.root)return;this.currentIndex=0;this.update();this.deferHeight();this.restartAutoAdvance()}
refresh(){this.update();this.deferHeight();this.restartAutoAdvance()}
startAutoAdvance(){if(this.slides.length<=1)return;this.stopAutoAdvance();this.autoAdvanceTimer=window.setInterval(()=>{if(!this.root||this.isTouching)return;if(this.root.offsetParent===null)return;this.showSlide(this.currentIndex+1,'auto')},this.autoAdvanceDelay)}
stopAutoAdvance(){if(this.autoAdvanceTimer){clearInterval(this.autoAdvanceTimer);this.autoAdvanceTimer=null}}
restartAutoAdvance(){this.stopAutoAdvance();this.startAutoAdvance()}
handleClick(event){const target=event.target;if(!target)return;if(target.closest('[data-carousel-prev]')){event.preventDefault();this.showSlide(this.currentIndex-1);this.restartAutoAdvance();return}
if(target.closest('[data-carousel-next]')){event.preventDefault();this.showSlide(this.currentIndex+1);this.restartAutoAdvance();return}
const dot=target.closest('[data-carousel-dot]');if(dot&&typeof dot.dataset.carouselDot!=='undefined'){event.preventDefault();const nextIndex=parseInt(dot.dataset.carouselDot,10);if(!Number.isNaN(nextIndex)){this.showSlide(nextIndex,'dot');this.restartAutoAdvance()}}}
handleKeydown(event){if(!this.root.contains(event.target))return;switch(event.key){case 'ArrowLeft':event.preventDefault();this.showSlide(this.currentIndex-1,'keyboard');this.restartAutoAdvance();break;case 'ArrowRight':event.preventDefault();this.showSlide(this.currentIndex+1,'keyboard');this.restartAutoAdvance();break;case 'Home':event.preventDefault();this.showSlide(0,'keyboard');this.restartAutoAdvance();break;case 'End':event.preventDefault();this.showSlide(this.slides.length-1,'keyboard');this.restartAutoAdvance();break;default:break}}
handleTouchStart(event){if(!event.changedTouches||event.changedTouches.length===0)return;this.isTouching=!0;this.touchStartX=event.changedTouches[0].clientX;this.touchDeltaX=0;this.stopAutoAdvance()}
handleTouchMove(event){if(!this.isTouching||!event.changedTouches||event.changedTouches.length===0)
return;this.touchDeltaX=event.changedTouches[0].clientX-this.touchStartX}
handleTouchEnd(){if(!this.isTouching)return;if(Math.abs(this.touchDeltaX)>40){if(this.touchDeltaX>0){this.showSlide(this.currentIndex-1,'swipe')}else{this.showSlide(this.currentIndex+1,'swipe')}}
this.isTouching=!1;this.touchStartX=0;this.touchDeltaX=0;this.restartAutoAdvance()}
handleResize(){this.deferHeight()}
cleanup(){if(!this.root)return;this.root.removeEventListener('click',this.handleClick);this.root.removeEventListener('keydown',this.handleKeydown);this.root.removeEventListener('touchstart',this.handleTouchStart);this.root.removeEventListener('touchmove',this.handleTouchMove);this.root.removeEventListener('touchend',this.handleTouchEnd);window.removeEventListener('resize',this.handleResize);this.stopAutoAdvance()}}
class MobileMenuManager{constructor(){this.burger=document.querySelector('.burger');this.menu=document.querySelector('.nav-menu');this.closeBtn=document.querySelector('.close-menu');this.overlay=document.querySelector('.menu-overlay');this.hideTimeout=null;this.scrollLocked=!1;this.savedBodyStyles=null;this.savedRootStyles=null;this.handleResize=this.handleResize.bind(this);this.updateVisibilityState=this.updateVisibilityState.bind(this);this.init();if(this.menu){this.updateVisibilityState();requestAnimationFrame(()=>{document.body.classList.add('menu-animations-ready');this.updateVisibilityState()})}
window.addEventListener('resize',this.handleResize)}
init(){this.setupEventListeners();this.bindMenuActions()}
setupEventListeners(){document.addEventListener('click',(e)=>{const burgerClicked=e.target.closest&&e.target.closest('.burger');const closeClicked=e.target.closest&&e.target.closest('.close-menu');const overlayClicked=this.overlay&&e.target===this.overlay;if(burgerClicked&&this.burger&&burgerClicked===this.burger){if(this.menu&&this.menu.classList.contains('active')){this.closeMenu()}else{this.openMenu()}}else if(closeClicked&&this.closeBtn&&closeClicked===this.closeBtn){this.closeMenu()}else if(overlayClicked){this.closeMenu()}else if(this.menu&&this.menu.classList.contains('active')&&!this.menu.contains(e.target)&&!this.burger.contains(e.target)){this.closeMenu()}});document.addEventListener('keydown',(e)=>{if(e.key==='Escape'&&this.menu&&this.menu.classList.contains('active')){this.closeMenu()}})}
bindMenuActions(){if(!this.menu)return;const triggers=this.menu.querySelectorAll('[data-popup-target]');triggers.forEach((trigger)=>{const openPopup=(event)=>{const target=trigger.dataset.popupTarget;if(!target||!window.popupManager)return;this.closeMenu({restoreFocus:!1});requestAnimationFrame(()=>{window.popupManager.openByTarget(target)})};trigger.addEventListener('click',openPopup);trigger.addEventListener('touchstart',(event)=>{if(event.touches&&event.touches.length>1)return;openPopup(event)})})}
openMenu(){if(!this.menu||!this.burger)return;if(!isMobileViewport()){this.updateVisibilityState();return}
if(this.menu.classList.contains('active'))return;if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}
if(this.menu.hasAttribute('hidden')){this.menu.removeAttribute('hidden');void this.menu.offsetHeight}
this.menu.setAttribute('aria-hidden','false');this.menu.classList.add('active');this.menu.scrollTop=0;this.burger.style.display='none';document.body.classList.add('menu-open');this.lockScroll();this.burger.setAttribute('aria-expanded','true')}
closeMenu({restoreFocus=!0}={}){if(!this.menu||!this.burger)return;const wasActive=this.menu.classList.contains('active');this.menu.classList.remove('active');if(!isMobileViewport()){this.updateVisibilityState()}else{this.burger.style.display='flex';document.body.classList.remove('menu-open');this.unlockScroll();this.menu.setAttribute('aria-hidden','true');if(this.hideTimeout)clearTimeout(this.hideTimeout);this.hideTimeout=setTimeout(()=>{if(this.menu&&!this.menu.classList.contains('active')&&window.innerWidth<=768){this.menu.setAttribute('hidden','')}},400);if(restoreFocus&&wasActive){this.burger.focus()}}
this.burger.setAttribute('aria-expanded','false');if(!isMobileViewport()){this.unlockScroll()}}
updateVisibilityState(){if(!this.menu)return;const isMobile=isMobileViewport();const menuActive=this.menu.classList.contains('active');if(isMobile){if(!menuActive){this.menu.setAttribute('aria-hidden','true');if(!this.menu.hasAttribute('hidden')){this.menu.setAttribute('hidden','')}
if(this.burger){this.burger.style.display='flex';this.burger.setAttribute('aria-expanded','false')}
document.body.classList.remove('menu-open');this.unlockScroll()}else{this.menu.removeAttribute('hidden');this.menu.setAttribute('aria-hidden','false');document.body.classList.add('menu-open');this.lockScroll();if(this.burger){this.burger.style.display='none';this.burger.setAttribute('aria-expanded','true')}}}else{if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}
this.menu.removeAttribute('hidden');this.menu.setAttribute('aria-hidden','false');this.menu.classList.remove('active');document.body.classList.remove('menu-open');this.unlockScroll();if(this.burger){this.burger.style.display='';this.burger.setAttribute('aria-expanded','false')}}}
lockScroll(){if(this.scrollLocked)return;this.scrollLocked=!0;const bodyStyle=document.body.style;const rootStyle=document.documentElement.style;this.savedBodyStyles={overflow:bodyStyle.overflow||'',overscrollBehavior:bodyStyle.overscrollBehavior||'',};this.savedRootStyles={overflow:rootStyle.overflow||'',overscrollBehavior:rootStyle.overscrollBehavior||'',};bodyStyle.overflow='hidden';bodyStyle.overscrollBehavior='contain';rootStyle.overflow='hidden';rootStyle.overscrollBehavior='contain'}
unlockScroll(){if(!this.scrollLocked)return;const bodyStyle=document.body.style;const rootStyle=document.documentElement.style;const savedBody=this.savedBodyStyles||{};const savedRoot=this.savedRootStyles||{};bodyStyle.overflow=savedBody.overflow||'';bodyStyle.overscrollBehavior=savedBody.overscrollBehavior||'';rootStyle.overflow=savedRoot.overflow||'';rootStyle.overscrollBehavior=savedRoot.overscrollBehavior||'';this.scrollLocked=!1;this.savedBodyStyles=null;this.savedRootStyles=null}
handleResize(){this.updateVisibilityState();if(!isMobileViewport()){this.closeMenu({restoreFocus:!1})}}}
class FormManager{constructor(){this.contactForm=document.getElementById('contact-form');this.successMessage=document.getElementById('form-success-message');this.init()}
init(){this.setupContactForm()}
setupContactForm(){if(!this.contactForm||!this.successMessage)return;this.contactForm.addEventListener('submit',async(e)=>{e.preventDefault();const formData=new FormData(this.contactForm);try{const response=await fetch(this.contactForm.action,{method:this.contactForm.method,headers:{Accept:'application/json'},body:formData,});if(response.ok){this.contactForm.reset();this.successMessage.classList.remove('hidden');setTimeout(()=>this.successMessage.classList.add('hidden'),5000)}else{alert("Erreur lors de l'envoi. Veuillez réessayer.")}}catch{alert('Erreur de réseau. Vérifiez votre connexion.')}})}}
class FAQManager{constructor(){this.faqSection=document.querySelector('.faq-section');this.faqQuestions=this.faqSection?.querySelectorAll('.faq-question')||[];this.lazyAttachThreshold=50;this.virtualScrollThreshold=Number.MAX_SAFE_INTEGER;this.ultraLargeThreshold=Number.MAX_SAFE_INTEGER;this.extremeThreshold=1000;this.attachedElements=new Set();this.intersectionObserver=null;this.virtualScrollEnabled=!1;this.visibleRange={start:0,end:0};this.init()}
init(){this.setupFAQ();if(this.faqQuestions.length>this.extremeThreshold){this.setupDOMRecycling()}else if(this.faqQuestions.length>this.ultraLargeThreshold){this.setupEnhancedVirtualScrolling()}else if(this.faqQuestions.length>this.virtualScrollThreshold){this.setupVirtualScrolling()}else if(this.faqQuestions.length>this.lazyAttachThreshold){this.setupLazyAttach()}}
setupFAQ(){const container=this.faqSection||document;container.addEventListener('click',(e)=>{const button=e.target?.closest?.('.faq-question');if(button)this.toggleFAQ(button);});container.addEventListener('keydown',(e)=>{const isActivateKey=e.key==='Enter'||e.key===' ';if(e.defaultPrevented||!isActivateKey)return;const button=e.target?.closest?.('.faq-question');if(button){e.preventDefault();this.toggleFAQ(button)}})}
setupLazyAttach(){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const faqItem=entry.target;if(!this.attachedElements.has(faqItem)){this.attachFAQEvents(faqItem);this.attachedElements.add(faqItem)}
this.intersectionObserver.unobserve(faqItem)}})},{threshold:0.1,rootMargin:'100px'},);this.faqQuestions.forEach((question)=>{this.intersectionObserver.observe(question)})}
attachFAQEvents(faqItem){}
setupVirtualScrolling(){this.virtualScrollEnabled=!0;const container=this.faqSection;if(!container)return;const virtualContainer=document.createElement('div');virtualContainer.className='virtual-faq-container';virtualContainer.style.height=`${this.faqQuestions.length * 60}px`;container.innerHTML='';container.appendChild(virtualContainer);this.setupVirtualScrollObserver(virtualContainer)}
setupVirtualScrollObserver(virtualContainer){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){this.updateVisibleFAQItems(entry.target)}})},{threshold:0.1,rootMargin:'200px'},);this.intersectionObserver.observe(virtualContainer)}
updateVisibleFAQItems(container){const scrollTop=container.scrollTop||window.pageYOffset;const containerHeight=container.clientHeight;const itemHeight=60;const start=Math.max(0,Math.floor(scrollTop/itemHeight)-5);const end=Math.min(this.faqQuestions.length,Math.ceil((scrollTop+containerHeight)/itemHeight)+5,);if(Math.abs(start-this.visibleRange.start)>3||Math.abs(end-this.visibleRange.end)>3){this.renderVisibleFAQItems(start,end);this.visibleRange={start,end}}}
renderVisibleFAQItems(start,end){}
setupEnhancedVirtualScrolling(){this.virtualScrollEnabled=!0;const container=this.faqSection;if(!container)return;const virtualContainer=document.createElement('div');virtualContainer.className='enhanced-virtual-faq-container';virtualContainer.style.height=`${this.faqQuestions.length * 60}px`;virtualContainer.style.position='relative';virtualContainer.style.willChange='transform';virtualContainer.style.contain='layout style paint';container.innerHTML='';container.appendChild(virtualContainer);this.setupEnhancedVirtualScrollObserver(virtualContainer);this.setupScrollThrottling(virtualContainer)}
setupEnhancedVirtualScrollObserver(virtualContainer){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){this.updateVisibleFAQItemsEnhanced(entry.target)}})},{threshold:0.05,rootMargin:'300px'},);this.intersectionObserver.observe(virtualContainer)}
updateVisibleFAQItemsEnhanced(container){const scrollTop=container.scrollTop||window.pageYOffset;const containerHeight=container.clientHeight;const itemHeight=60;const bufferSize=Math.min(20,Math.ceil(containerHeight/itemHeight));const start=Math.max(0,Math.floor(scrollTop/itemHeight)-bufferSize);const end=Math.min(this.faqQuestions.length,Math.ceil((scrollTop+containerHeight)/itemHeight)+bufferSize,);if(Math.abs(start-this.visibleRange.start)>5||Math.abs(end-this.visibleRange.end)>5){this.renderVisibleFAQItemsEnhanced(start,end);this.visibleRange={start,end}}}
renderVisibleFAQItemsEnhanced(start,end){}
setupScrollThrottling(container){let scrollTimeout;container.addEventListener('scroll',()=>{clearTimeout(scrollTimeout);scrollTimeout=setTimeout(()=>{this.updateVisibleFAQItemsEnhanced(container)},16)},{passive:!0},)}
setupDOMRecycling(){this.virtualScrollEnabled=!0;this.domRecyclingEnabled=!0;const container=this.faqSection;if(!container)return;const virtualContainer=document.createElement('div');virtualContainer.className='dom-recycled-faq-container';virtualContainer.style.height=`${this.faqQuestions.length * 60}px`;virtualContainer.style.position='relative';virtualContainer.style.willChange='transform';virtualContainer.style.contain='layout style paint';virtualContainer.style.overflow='hidden';container.innerHTML='';container.appendChild(virtualContainer);this.setupDOMRecyclingObserver(virtualContainer);this.setupScrollThrottling(virtualContainer)}
setupDOMRecyclingObserver(virtualContainer){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){this.updateDOMRecycledItems(entry.target)}})},{threshold:0.01,rootMargin:'100px'},);this.intersectionObserver.observe(virtualContainer)}
updateDOMRecycledItems(container){const scrollTop=container.scrollTop||window.pageYOffset;const containerHeight=container.clientHeight;const itemHeight=60;const bufferSize=5;const start=Math.max(0,Math.floor(scrollTop/itemHeight)-bufferSize);const end=Math.min(this.faqQuestions.length,Math.ceil((scrollTop+containerHeight)/itemHeight)+bufferSize,);if(Math.abs(start-this.visibleRange.start)>2||Math.abs(end-this.visibleRange.end)>2){this.renderDOMRecycledItems(start,end,container);this.visibleRange={start,end}}}
renderDOMRecycledItems(start,end,container){container.innerHTML='';for(let i=start;i<end;i++){const item=this.createRecycledFAQItem(i);container.appendChild(item)}}
createRecycledFAQItem(index){const item=document.createElement('div');item.className='faq-item-recycled';item.style.position='absolute';item.style.top=`${index * 60}px`;item.style.height='60px';item.textContent=`FAQ Item ${index + 1}`;return item}
toggleFAQ(button){const answer=button.nextElementSibling;const isOpen=button.getAttribute('aria-expanded')==='true';if(isOpen){answer.style.maxHeight='0';button.setAttribute('aria-expanded','false');answer.classList.remove('open')}else{document.querySelectorAll('.faq-question[aria-expanded="true"]').forEach((openBtn)=>{if(openBtn!==button){const openAnswer=openBtn.nextElementSibling;if(openAnswer){openAnswer.style.maxHeight='0';openAnswer.classList.remove('open')}
openBtn.setAttribute('aria-expanded','false')}});answer.style.maxHeight='';answer.style.maxHeight=answer.scrollHeight+'px';button.setAttribute('aria-expanded','true');answer.classList.add('open')}}
cleanup(){if(this.intersectionObserver){this.intersectionObserver.disconnect();this.intersectionObserver=null}
this.attachedElements.clear();if(this.mostVisibleObserver){this.mostVisibleObserver.disconnect();this.mostVisibleObserver=null}
if(this.mostVisibleMutationObserver){this.mostVisibleMutationObserver.disconnect();this.mostVisibleMutationObserver=null}
if(this.mostVisibleResizeHandler){window.removeEventListener('resize',this.mostVisibleResizeHandler,{passive:!0,});this.mostVisibleResizeHandler=null}}}
class CasinoButtonsManager{constructor(){this.casinoContainer=document.querySelector('.casino-cards-container');this.casinoButtons=this.casinoContainer?.querySelectorAll('.casino-card__button')||[];this.lazyAttachThreshold=30;this.virtualScrollThreshold=Number.MAX_SAFE_INTEGER;this.ultraLargeThreshold=Number.MAX_SAFE_INTEGER;this.attachedElements=new Set();this.intersectionObserver=null;this.virtualScrollEnabled=!1;this.visibleRange={start:0,end:0};this.init()}
init(){this.setupCasinoButtons();if(typeof window!=='undefined'&&window.matchMedia){if(window.matchMedia('(max-width: 767px)').matches){this.setupMostVisibleHighlighting()}}
if(this.casinoButtons.length>this.ultraLargeThreshold){this.setupEnhancedVirtualScrolling()}else if(this.casinoButtons.length>this.virtualScrollThreshold){this.setupVirtualScrolling()}else if(this.casinoButtons.length>this.lazyAttachThreshold){this.setupLazyAttach()}}
setupCasinoButtons(){const container=this.casinoContainer||document;container.addEventListener('keydown',(e)=>{const isActivateKey=e.key==='Enter'||e.key===' ';if(!isActivateKey)return;const casinoBtn=e.target?.closest?.('.casino-card__button');if(casinoBtn){e.preventDefault();casinoBtn.click();return}
const link=e.target?.closest?.('.footer__link');if(link){if(link.id==='privacy-link'||link.id==='cookie-settings-link')
return;const href=link.getAttribute('href');if(link.hasAttribute('disabled')||link.getAttribute('aria-disabled')==='true')
return;if(href==='#about'||href==='#contact')return;e.preventDefault();link.click()}})}
setupLazyAttach(){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const casinoCard=entry.target;if(!this.attachedElements.has(casinoCard)){this.attachCasinoEvents(casinoCard);this.attachedElements.add(casinoCard)}
this.intersectionObserver.unobserve(casinoCard)}})},{threshold:0.1,rootMargin:'100px'},);this.casinoButtons.forEach((button)=>{const casinoCard=button.closest('.casino-card');if(casinoCard){this.intersectionObserver.observe(casinoCard)}})}
attachCasinoEvents(casinoCard){}
setupMostVisibleHighlighting(){const collectCards=()=>{const cards=Array.from(document.querySelectorAll('.casino-card, .casino-card--top, .top-card'),).filter(Boolean);if(!cards.length)return;if(this.mostVisibleRatios)this.mostVisibleRatios.clear();cards.forEach((c)=>{if(!this.mostVisibleObserved||!this.mostVisibleObserved.has(c)){this.mostVisibleObserved=this.mostVisibleObserved||new Set();this.mostVisibleObserved.add(c);this.mostVisibleObserver.observe(c)}
this.mostVisibleRatios.set(c,0)})};this.mostVisibleRatios=new Map();this.mostVisibleObserved=new Set();let mostVisibleCard=null;const hwConcurrency=navigator.hardwareConcurrency||4;const saveData=navigator.connection&&navigator.connection.saveData;const defaultInterval=hwConcurrency<=2||saveData?200:100;this.mostVisibleMinInterval=defaultInterval;this.mostVisibleScheduled=!1;const thresholds=[];for(let i=0;i<=100;i+=5)thresholds.push(i/100);const applyMostVisible=()=>{let maxRatio=0;let maxEl=null;this.mostVisibleRatios.forEach((r,el)=>{if(r>maxRatio){maxRatio=r;maxEl=el}});if(maxEl!==mostVisibleCard){if(mostVisibleCard){mostVisibleCard.classList.remove('most-visible');mostVisibleCard.classList.remove('primary-most-visible')}
mostVisibleCard=maxEl;if(mostVisibleCard)mostVisibleCard.classList.add('most-visible');}};const scheduleMostVisibleUpdate=()=>{if(this.mostVisibleScheduled)return;this.mostVisibleScheduled=!0;setTimeout(()=>{applyMostVisible();this.mostVisibleScheduled=!1},this.mostVisibleMinInterval)};this.mostVisibleObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{const el=entry.target;this.mostVisibleRatios.set(el,entry.intersectionRatio||0)});scheduleMostVisibleUpdate()},{threshold:thresholds},);const container=document.querySelector('.casino-cards-container')||document;this.mostVisibleMutationObserver=new MutationObserver(()=>{collectCards()});if(container&&container.nodeType===1){this.mostVisibleMutationObserver.observe(container,{childList:!0,subtree:!0,})}
collectCards();this.mostVisibleResizeHandler=()=>{if(window.matchMedia('(max-width: 1024px)').matches){collectCards()}else{if(this.mostVisibleObserver){this.mostVisibleObserver.disconnect()}
if(mostVisibleCard){mostVisibleCard.classList.remove('most-visible');mostVisibleCard=null}}};window.addEventListener('resize',this.mostVisibleResizeHandler,{passive:!0,});window.addEventListener('resize',this.mostVisibleResizeHandler,{passive:!0,})}
setupVirtualScrolling(){this.virtualScrollEnabled=!0;const container=this.casinoContainer;if(!container)return;const virtualContainer=document.createElement('div');virtualContainer.className='virtual-casino-container';virtualContainer.style.height=`${this.casinoButtons.length * 200}px`;container.innerHTML='';container.appendChild(virtualContainer);this.setupVirtualScrollObserver(virtualContainer)}
setupVirtualScrollObserver(virtualContainer){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){this.updateVisibleCasinoCards(entry.target)}})},{threshold:0.1,rootMargin:'200px'},);this.intersectionObserver.observe(virtualContainer)}
updateVisibleCasinoCards(container){const scrollTop=container.scrollTop||window.pageYOffset;const containerHeight=container.clientHeight;const itemHeight=200;const start=Math.max(0,Math.floor(scrollTop/itemHeight)-3);const end=Math.min(this.casinoButtons.length,Math.ceil((scrollTop+containerHeight)/itemHeight)+3,);if(Math.abs(start-this.visibleRange.start)>2||Math.abs(end-this.visibleRange.end)>2){this.renderVisibleCasinoCards(start,end);this.visibleRange={start,end}}}
renderVisibleCasinoCards(start,end){}
setupEnhancedVirtualScrolling(){this.virtualScrollEnabled=!0;const container=this.casinoContainer;if(!container)return;const virtualContainer=document.createElement('div');virtualContainer.className='enhanced-virtual-casino-container';virtualContainer.style.height=`${this.casinoButtons.length * 200}px`;virtualContainer.style.position='relative';virtualContainer.style.willChange='transform';virtualContainer.style.contain='layout style paint';container.innerHTML='';container.appendChild(virtualContainer);this.setupEnhancedVirtualScrollObserver(virtualContainer);this.setupScrollThrottling(virtualContainer)}
setupEnhancedVirtualScrollObserver(virtualContainer){this.intersectionObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){this.updateVisibleCasinoCardsEnhanced(entry.target)}})},{threshold:0.05,rootMargin:'400px'},);this.intersectionObserver.observe(virtualContainer)}
updateVisibleCasinoCardsEnhanced(container){const scrollTop=container.scrollTop||window.pageYOffset;const containerHeight=container.clientHeight;const itemHeight=200;const bufferSize=Math.min(10,Math.ceil(containerHeight/itemHeight));const start=Math.max(0,Math.floor(scrollTop/itemHeight)-bufferSize);const end=Math.min(this.casinoButtons.length,Math.ceil((scrollTop+containerHeight)/itemHeight)+bufferSize,);if(Math.abs(start-this.visibleRange.start)>3||Math.abs(end-this.visibleRange.end)>3){this.renderVisibleCasinoCardsEnhanced(start,end);this.visibleRange={start,end}}}
renderVisibleCasinoCardsEnhanced(start,end){}
setupScrollThrottling(container){let scrollTimeout;container.addEventListener('scroll',()=>{clearTimeout(scrollTimeout);scrollTimeout=setTimeout(()=>{this.updateVisibleCasinoCardsEnhanced(container)},16)},{passive:!0},)}
cleanup(){if(this.intersectionObserver){this.intersectionObserver.disconnect();this.intersectionObserver=null}
this.attachedElements.clear()}}
class AnimationManager{constructor(){this.headerLogo=document.querySelector('.header__logo');this.disclaimer=document.querySelector('.disclaimer');this.reduceMotion=window.matchMedia?.('(prefers-reduced-motion: reduce)',).matches;this.init()}
init(){this.setupHeaderLogoAnimation();this.setupBellAnimation()}
setupHeaderLogoAnimation(){if(!this.headerLogo||this.reduceMotion)return;this.headerLogo.classList.add('rotate-once');const runLogoRotate=(e)=>{if(this.reduceMotion)return;this.headerLogo.classList.add('rotate-once');if(e&&e.type==='keydown')e.preventDefault();};this.headerLogo.addEventListener('click',runLogoRotate);this.headerLogo.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' ')runLogoRotate(e);});this.headerLogo.addEventListener('animationend',()=>{this.headerLogo.classList.remove('rotate-once')})}
setupBellAnimation(){if(!this.disclaimer||this.reduceMotion)return;setTimeout(()=>{this.disclaimer.classList.add('bell-start');setTimeout(()=>{this.disclaimer.classList.remove('bell-start')},2000)},2000);this.disclaimer.addEventListener('mouseenter',()=>{this.disclaimer.classList.add('bell-start');setTimeout(()=>{this.disclaimer.classList.remove('bell-start')},2000)})}}
class ScrollRevealManager{constructor(){this.elements=document.querySelectorAll('.fade-in');this.faqSection=document.querySelector('.faq-section');this.casinoSection=document.querySelector('.casino-cards-container');this.heroSection=document.querySelector('.hero-section');this.sectionElements={faq:this.faqSection?Array.from(this.faqSection.querySelectorAll('.fade-in')):[],casino:this.casinoSection?Array.from(this.casinoSection.querySelectorAll('.fade-in')):[],hero:this.heroSection?Array.from(this.heroSection.querySelectorAll('.fade-in')):[],other:[],};this.adaptiveConfig=this.getAdaptiveConfig();this.animationOnce=!0;this.sectionOnceSettings={faq:!0,casino:!0,hero:!1,other:!0,};this.elementOnceSettings=new Map();this.enableScrollUpAnimations=!0;this.init()}
getAdaptiveConfig(){const isMobile=window.innerWidth<=768;const isTablet=window.innerWidth<=1024;const isLargeScreen=window.innerWidth>1440;const isUltraWide=window.innerWidth>1920;const pageHeight=document.documentElement.scrollHeight;const viewportHeight=window.innerHeight;const isLongPage=pageHeight>viewportHeight*3;const isVeryLongPage=pageHeight>viewportHeight*5;const totalFadeElements=this.elements.length;const isHighElementCount=totalFadeElements>100;let rootMargin='0px 0px -5px 0px';if(isMobile){rootMargin='0px 0px -2px 0px'}else if(isVeryLongPage||isHighElementCount){rootMargin='0px 0px -50px 0px'}else if(isLongPage){rootMargin='0px 0px -20px 0px'}
let threshold=isMobile?0.01:isTablet?0.08:0.05;if(isVeryLongPage||isHighElementCount){threshold=Math.max(0.01,threshold*0.5)}
return{threshold,rootMargin,sectionThreshold:isMobile?10:isTablet?15:20,once:!0,isLongPage,isVeryLongPage,isHighElementCount,totalElements:totalFadeElements,}}
init(){if(!this.elements.length)return;this.categorizeElements();this.showVisibleElementsImmediately();this.setupSectionObservers();this.setupResizeListener()}
showVisibleElementsImmediately(){const viewportHeight=window.innerHeight;const viewportWidth=window.innerWidth;this.elements.forEach((element)=>{const rect=element.getBoundingClientRect();const isInViewport=rect.top<viewportHeight*0.9&&rect.bottom>0&&rect.left<viewportWidth&&rect.right>0;if(isInViewport){element.classList.add('visible')}})}
setupResizeListener(){let resizeTimeout;window.addEventListener('resize',()=>{clearTimeout(resizeTimeout);resizeTimeout=setTimeout(()=>{this.adaptiveConfig=this.getAdaptiveConfig();this.recreateObservers()},250)})}
categorizeElements(){const allElements=Array.from(this.elements);allElements.forEach((element)=>{if(this.faqSection&&this.faqSection.contains(element)){this.sectionElements.faq.push(element)}else if(this.casinoSection&&this.casinoSection.contains(element)){this.sectionElements.casino.push(element)}else if(this.heroSection&&this.heroSection.contains(element)){this.sectionElements.hero.push(element)}else{this.sectionElements.other.push(element)}})}
setupSectionObservers(){Object.entries(this.sectionElements).forEach(([sectionName,elements])=>{if(elements.length===0)return;if(elements.length>this.adaptiveConfig.sectionThreshold){this.createSectionObserver(sectionName,elements)}else{this.useGlobalObserver(elements)}})}
createSectionObserver(sectionName,elements){const observer=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){entry.target.classList.add('visible');const elementOnce=this.getElementOnce(entry.target);if(elementOnce&&entry.intersectionRatio>=0.5){observer.unobserve(entry.target)}}else if(this.enableScrollUpAnimations&&window.innerWidth>768){entry.target.classList.remove('visible')}})},{threshold:this.adaptiveConfig.threshold,rootMargin:this.adaptiveConfig.rootMargin,},);observerRegistry.scrollObservers.set(sectionName,observer);elements.forEach((el)=>observer.observe(el))}
useGlobalObserver(elements){if(!observerRegistry.globalScrollObserver){observerRegistry.globalScrollObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){entry.target.classList.add('visible');if(entry.intersectionRatio>=0.5){observerRegistry.globalScrollObserver.unobserve(entry.target)}}else if(this.enableScrollUpAnimations&&window.innerWidth>768){entry.target.classList.remove('visible')}})},{threshold:this.adaptiveConfig.threshold,rootMargin:this.adaptiveConfig.rootMargin,},)}
elements.forEach((el)=>observerRegistry.globalScrollObserver.observe(el))}
recreateObservers(){this.cleanup();this.setupSectionObservers()}
setScrollUpAnimations(enabled){this.enableScrollUpAnimations=enabled}
setElementOnce(element,once){if(element&&element.nodeType===Node.ELEMENT_NODE){this.elementOnceSettings.set(element,once)}}
getElementOnce(element){if(element&&this.elementOnceSettings.has(element)){return this.elementOnceSettings.get(element)}
const section=this.getElementSection(element);return this.sectionOnceSettings[section]??!0}
getElementSection(element){if(this.faqSection&&this.faqSection.contains(element))return'faq';if(this.casinoSection&&this.casinoSection.contains(element))
return'casino';if(this.heroSection&&this.heroSection.contains(element))return'hero';return'other'}
getAnimationSettings(){return{enableScrollUpAnimations:this.enableScrollUpAnimations,sectionOnceSettings:this.sectionOnceSettings,adaptiveConfig:this.adaptiveConfig,elementOnceSettings:Array.from(this.elementOnceSettings.entries()),}}
cleanup(){observerRegistry.scrollObservers.forEach((observer)=>observer.disconnect(),);observerRegistry.scrollObservers.clear();if(observerRegistry.globalScrollObserver){observerRegistry.globalScrollObserver.disconnect();observerRegistry.globalScrollObserver=null}}}
class DarkModeManager{constructor(){this.toggleButton=document.getElementById('theme-toggle');this.themeIcon=document.querySelector('.theme-icon');this.body=document.body;this.casinoImages=document.querySelectorAll('.casino-card__image');this.mutationObserver=null;this.observedContainers=new Set();this.pendingUpdates=new Set();this.updateScheduled=!1;this.init()}
init(){this.loadSavedTheme();if(this.toggleButton&&this.body){this.setupEventListeners();this.setupMutationObserver()}}
loadSavedTheme(){if(!this.body)return;const savedTheme=localStorage.getItem('theme');let isDark;if(savedTheme){this.body.classList.add(savedTheme);isDark=savedTheme==='dark';this.updateToggleButtonState(isDark)}else{const prefersDark=window.matchMedia('(prefers-color-scheme: dark)',).matches;this.body.classList.add(prefersDark?'dark':'light');isDark=prefersDark;this.updateToggleButtonState(isDark)}
this.updateToggleUI(isDark);this.updateToggleButtonState(isDark);this.updateLogos();window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',(e)=>{if(!localStorage.getItem('theme')){const isDark=e.matches;if(!this.body)return;this.body.classList.toggle('dark',isDark);this.body.classList.toggle('light',!isDark);this.updateToggleUI(isDark);this.updateLogos();this.updateToggleButtonState(isDark)}})}
setupEventListeners(){if(!this.toggleButton)return;this.toggleButton.addEventListener('click',()=>this.toggleTheme())}
setupMutationObserver(){if(!this.mutationObserver){this.mutationObserver=new MutationObserver((mutations)=>{mutations.forEach((mutation)=>{if(mutation.type==='childList'){mutation.addedNodes.forEach((node)=>{if(node.nodeType===Node.ELEMENT_NODE){const casinoImages=node.matches?.('.casino-card__image')?[node]:node.querySelectorAll?.('.casino-card__image')||[];if(casinoImages.length>0){casinoImages.forEach((img)=>this.pendingUpdates.add(img))}}})}});this.scheduleBatchedUpdate()})}
const containers=[document.querySelector('.casino-cards-container'),document.querySelector('.casino-section'),document.querySelector('.main-content'),].filter(Boolean);containers.forEach((container)=>{if(!this.observedContainers.has(container)){this.mutationObserver.observe(container,{childList:!0,subtree:!0,});this.observedContainers.add(container)}})}
scheduleBatchedUpdate(){if(this.updateScheduled)return;this.updateScheduled=!0;requestAnimationFrame(()=>{this.processBatchedUpdates();this.updateScheduled=!1})}
processBatchedUpdates(){if(this.pendingUpdates.size===0)return;const images=Array.from(this.pendingUpdates);this.pendingUpdates.clear();this.updateDynamicLogos(images)}
updateDynamicLogos(images){const isDark=this.body.classList.contains('dark');images.forEach((img)=>{const darkSrc=img.dataset.dark;if(!darkSrc)return;if(isDark){if(!img.dataset.light){img.dataset.light=img.src}
img.src=darkSrc}else if(img.dataset.light){img.src=img.dataset.light}})}
updateNewCasinoCards(container=null){const targetContainer=container||document;const newImages=targetContainer.querySelectorAll('.casino-card__image');if(newImages.length>0){this.updateDynamicLogos(Array.from(newImages))}}
forceUpdateAllLogos(){this.updateLogos();const allCasinoImages=document.querySelectorAll('.casino-card__image');this.updateDynamicLogos(Array.from(allCasinoImages))}
toggleTheme(){if(!this.body)return;const isDark=!this.body.classList.contains('dark');this.body.classList.toggle('dark',isDark);this.body.classList.toggle('light',!isDark);this.updateToggleUI(isDark);this.updateToggleButtonState(isDark);localStorage.setItem('theme',isDark?'dark':'light');this.updateLogos()}
updateToggleUI(isDark){if(this.themeIcon){this.themeIcon.textContent=isDark?'☀️':'🌙'}}
updateToggleButtonState(isDark){if(this.toggleButton){if(isDark){this.toggleButton.classList.add('active');this.toggleButton.classList.add('dark-mode')}else{this.toggleButton.classList.remove('active');this.toggleButton.classList.remove('dark-mode');this.toggleButton.classList.add('light-mode')}}}
updateLogos(){if(!this.body)return;const isDark=this.body.classList.contains('dark');const allCasinoImages=document.querySelectorAll('img[data-dark]');allCasinoImages.forEach((img)=>{const darkSrc=img.dataset.dark;if(!darkSrc)return;if(isDark){if(!img.dataset.light){img.dataset.light=img.src}
img.src=darkSrc}else if(img.dataset.light){img.src=img.dataset.light}
if(img.srcset){if(isDark){if(!img.dataset.originalSrcset){img.dataset.originalSrcset=img.srcset}
img.srcset=''}else{if(img.dataset.originalSrcset){img.srcset=img.dataset.originalSrcset}}}})}
cleanup(){if(this.mutationObserver){this.mutationObserver.disconnect();this.mutationObserver=null}
this.observedContainers.clear()}}
document.addEventListener('DOMContentLoaded',()=>{const fadeIns=Array.from(document.querySelectorAll('.fade-in'));fadeIns.forEach((el)=>{el.classList.add('visible')});document.documentElement.style.overflow='';document.body.classList.remove('menu-open','modal-open');window.cookieConsentManager=new CookieConsentManager();window.popupManager=new PopupManager();window.mobileMenuManager=new MobileMenuManager();window.formManager=new FormManager();window.faqManager=new FAQManager();window.darkModeManager=new DarkModeManager();window.aboutCarousel=new AboutCarousel();const avisToggle=document.querySelector('.avis-toggle');const avisWrapper=document.querySelector('.avis-wrapper');if(avisToggle&&avisWrapper){avisToggle.addEventListener('click',(e)=>{e.preventDefault();avisWrapper.classList.toggle('open');const expanded=avisWrapper.classList.contains('open');avisToggle.setAttribute('aria-expanded',expanded?'true':'false');const dropdown=document.getElementById('avis-list');if(dropdown){dropdown.hidden=!expanded;dropdown.setAttribute('aria-hidden',expanded?'false':'true')}})}
const header=document.querySelector('.header');if(header){let ticking=!1;const updateHeader=(scrollY)=>{if(scrollY>10){header.classList.add('scrolled')}else{header.classList.remove('scrolled')}
ticking=!1};const onScroll=()=>{if(!ticking){ticking=!0;window.requestAnimationFrame(()=>{const scrollY=window.scrollY;updateHeader(scrollY)})}};window.addEventListener('scroll',onScroll,{passive:!0});updateHeader(window.scrollY)}
const scrollBtn=document.getElementById('scrolltop');if(scrollBtn){window.addEventListener('scroll',()=>{if(window.scrollY>300){scrollBtn.classList.add('show')}else{scrollBtn.classList.remove('show')}});scrollBtn.addEventListener('click',(e)=>{e.preventDefault();window.scrollTo({top:0,behavior:'smooth'})});scrollBtn.addEventListener('mouseup',(e)=>{setTimeout(()=>{if(!scrollBtn.matches(':hover')){scrollBtn.style.backgroundColor=''}},50)});scrollBtn.addEventListener('mouseleave',()=>{scrollBtn.style.backgroundColor=''});scrollBtn.addEventListener('touchend',()=>{setTimeout(()=>{scrollBtn.style.backgroundColor=''},100)})}
window.scrollRevealManager=new ScrollRevealManager();const defer=window.requestIdleCallback||((cb)=>setTimeout(cb,200));defer(()=>{window.animationManager=new AnimationManager()});(function setupInputMethodDetection(){let usingKeyboard=!1;const body=document.body;if(!body)return;const keyboardKeys=new Set(['Tab','ArrowUp','ArrowDown','ArrowLeft','ArrowRight','Escape',]);window.addEventListener('keydown',(e)=>{if(keyboardKeys.has(e.key)){usingKeyboard=!0;body.classList.add('user-is-tabbing')}},{passive:!0},);const disableKeyboardMode=()=>{if(!usingKeyboard)return;usingKeyboard=!1;body.classList.remove('user-is-tabbing')};window.addEventListener('mousedown',disableKeyboardMode,{passive:!0,});window.addEventListener('touchstart',disableKeyboardMode,{passive:!0,});window.addEventListener('pointerdown',disableKeyboardMode,{passive:!0,})})();(function preventCardFocusOnTouch(){if(typeof document==='undefined')return;document.addEventListener('focusin',function(e){try{if(document.body.classList.contains('user-is-tabbing'))return;const card=e.target&&e.target.closest&&e.target.closest('.casino-card');if(card){if(e.target&&typeof e.target.blur==='function'){e.target.blur()}else if(document.activeElement&&typeof document.activeElement.blur==='function'){document.activeElement.blur()}}}catch(err){}},!0,)})()});window.clearCookies=function(){if(window.cookieConsentManager){window.cookieConsentManager.clearConsent()}};window.addEventListener('beforeunload',()=>{if(window.scrollRevealManager){window.scrollRevealManager.cleanup()}
if(window.darkModeManager){window.darkModeManager.cleanup()}
if(window.faqManager){window.faqManager.cleanup()}
if(window.casinoButtonsManager){window.casinoButtonsManager.cleanup()}});const mobileScrollSafeguard=()=>{if(window.innerWidth>768)return;const unblock=()=>{if(document.body.classList.contains('menu-open')||document.body.classList.contains('modal-open')){return}
document.documentElement.style.overflow='auto'};['touchstart','touchend','touchcancel','touchmove'].forEach((evt)=>{window.addEventListener(evt,unblock,{passive:!0})})};mobileScrollSafeguard()